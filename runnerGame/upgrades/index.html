<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Upgrades - Cyber Runner | Rase Games</title>
    
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/auth.css">
    
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#3b82f6",
                        "background-dark": "#0a0f1a",
                        "surface-dark": "#111827",
                        "surface-border": "#1e3a5f",
                        "text-muted": "#94a3b8"
                    },
                    fontFamily: { "display": ["Space Grotesk", "sans-serif"] }
                },
            },
        }
    </script>
    <style>
        body {
            background: #0a0f1a !important;
        }
    </style>
</head>

<body class="bg-background-dark text-white font-display min-h-screen">
    
    <nav class="navbar">
        <a href="/index.html" class="nav-logo">
            <span class="logo-icon">ðŸŽ®</span>
            <span class="logo-text">Rase Games</span>
        </a>
        <div class="nav-links">
            <a href="/index.html" class="nav-link">Games</a>
            <a href="/about.html" class="nav-link">About</a>
            <a href="/leaderboard.html" class="nav-link">Leaderboards</a>
        </div>
        <div id="user-display"></div>
    </nav>

    
    <main class="pt-24 px-4 pb-8 max-w-5xl mx-auto">
        
        <div class="flex items-center justify-between mb-8 flex-wrap gap-4">
            <div class="flex items-center gap-4">
                <a href="/runnerGame/"
                    class="flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-dark hover:bg-surface-border text-text-muted hover:text-white transition-all border border-surface-border">
                    <span class="material-symbols-outlined">arrow_back</span>
                    <span class="font-bold text-sm">BACK</span>
                </a>
                <h1 class="text-2xl font-bold text-white">UPGRADES</h1>
            </div>
            <div class="flex items-center gap-2 bg-surface-dark border border-surface-border rounded-lg h-10 px-4">
                <span class="material-symbols-outlined text-primary">diamond</span>
                <span id="coinDisplay" class="text-white font-bold">0</span>
            </div>
        </div>

        
        <div id="upgradeGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
    </main>

    <script src="/auth.js"></script>
    <script>
        // Cookie helpers
        function setCookie(name, value, days = 365) {
            const d = new Date();
            d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
            document.cookie = `${name}=${value};expires=${d.toUTCString()};path=/`;
        }
        function getCookie(name) {
            const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
            return match ? match[2] : null;
        }

        // Data
        let totalCoins = parseInt(getCookie('crCoins')) || 0;

        const upgrades = {
            doubleJump: { level: 0, maxLevel: 1, baseCost: 100, name: 'Double Jump', icon: 'â¬†ï¸', desc: 'Jump again mid-air' },
            magnet: { level: 0, maxLevel: 3, baseCost: 50, name: 'Coin Magnet', icon: 'ðŸ§²', desc: 'Attract nearby coins' },
            coinBonus: { level: 0, maxLevel: 5, baseCost: 75, name: 'Coin Bonus', icon: 'ðŸ’°', desc: '+50% coin value per level' },
            jumpHeight: { level: 0, maxLevel: 3, baseCost: 120, name: 'Jump Boost', icon: 'ðŸš€', desc: '+15% jump height per level' }
        };

        // Load saved upgrades
        const saved = getCookie('crUpgrades');
        if (saved) {
            try {
                const parsed = JSON.parse(decodeURIComponent(saved));
                Object.keys(parsed).forEach(k => { if (upgrades[k]) upgrades[k].level = parsed[k]; });
            } catch (e) { }
        }

        function updateDisplay() {
            document.getElementById('coinDisplay').textContent = totalCoins;
        }

        function renderGrid() {
            const grid = document.getElementById('upgradeGrid');
            grid.innerHTML = '';

            Object.entries(upgrades).forEach(([key, upg]) => {
                const cost = upg.baseCost * (upg.level + 1);
                const maxed = upg.level >= upg.maxLevel;
                const canBuy = totalCoins >= cost && !maxed;

                const card = document.createElement('div');
                card.className = `bg-surface-dark border border-surface-border rounded-xl p-5 flex flex-col gap-3 transition-all ${maxed ? 'opacity-60' : 'hover:border-primary hover:shadow-[0_0_15px_rgba(59,130,246,0.15)]'}`;

                card.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span class="text-3xl">${upg.icon}</span>
                        ${maxed ? '<span class="text-xs bg-primary/20 text-primary px-2 py-1 rounded font-bold">MAX</span>' : ''}
                    </div>
                    <h3 class="text-lg font-bold text-white">${upg.name}</h3>
                    <p class="text-sm text-text-muted">${upg.desc}</p>
                    <div class="flex gap-1 mt-1">
                        ${Array(upg.maxLevel).fill(0).map((_, i) => `<div class="h-1.5 flex-1 rounded-full ${i < upg.level ? 'bg-primary' : 'bg-surface-border'}"></div>`).join('')}
                    </div>
                    <div class="flex items-center justify-between mt-2 pt-3 border-t border-surface-border">
                        <span class="text-sm text-text-muted">Level ${upg.level}/${upg.maxLevel}</span>
                        ${maxed ? '' : `<button onclick="buyUpgrade('${key}')" class="flex items-center gap-1 px-4 py-2 rounded-lg font-bold text-sm transition-all ${canBuy ? 'bg-primary hover:bg-primary/80 text-white' : 'bg-surface-border text-text-muted cursor-not-allowed'}">
                            <span class="material-symbols-outlined text-sm">diamond</span>
                            ${cost}
                        </button>`}
                    </div>
                `;

                grid.appendChild(card);
            });
        }

        function buyUpgrade(key) {
            const upg = upgrades[key];
            const cost = upg.baseCost * (upg.level + 1);

            if (totalCoins >= cost && upg.level < upg.maxLevel) {
                totalCoins -= cost;
                upg.level++;

                setCookie('crCoins', totalCoins);
                setCookie('crUpgrades', encodeURIComponent(JSON.stringify(
                    Object.fromEntries(Object.entries(upgrades).map(([k, v]) => [k, v.level]))
                )));

                updateDisplay();
                renderGrid();
            }
        }

        // Init
        updateDisplay();
        renderGrid();
    </script>
</body>

</html>